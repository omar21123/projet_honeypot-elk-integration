#include <tunables/global>

profile ecom_honeypot /usr/bin/python3 {
  #include <abstractions/base>
  
  capability net_bind_service,
  
  # Whitelist explicite - seulement ces chemins
  /home/kali/Downloads/projet_honeypot-elk-integration/app/app.py r,
  /home/kali/Downloads/projet_honeypot-elk-integration/app/seccomp_config.py r,
  /home/kali/Downloads/projet_honeypot-elk-integration/app/database.db rwk,
  /home/kali/Downloads/projet_honeypot-elk-integration/app/uploads/ rw,
  /home/kali/Downloads/projet_honeypot-elk-integration/app/uploads/** rwk,
  /home/kali/Downloads/projet_honeypot-elk-integration/logs/ rw,
  /home/kali/Downloads/projet_honeypot-elk-integration/logs/ecom_honeypot.log w,
  
  # Python runtime minimal
  /usr/bin/python3.11 mr,
  /usr/lib/python3.11/**.so mr,
  /usr/local/lib/python3.11/dist-packages/** r,
  
  network inet stream,
  
  # Refus explicite de tout accès système
  deny /etc/** r,
  deny /bin/** r,
  deny /usr/bin/** r,
  deny /var/** r,
  deny /tmp/** r,
  deny /proc/** r,
  deny /sys/** r,
}
